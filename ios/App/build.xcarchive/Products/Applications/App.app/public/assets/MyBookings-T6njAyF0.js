import{aC as W,aD as X,b1 as Y,u as q,aY as Q,b2 as ee,r as _,c as N,aE as te,aF as se,o as S,aG as r,aH as l,aS as oe,aI as e,aN as d,aT as ae,aM as m,aJ as n,aK as ne,aL as re,aW as H,aX as le}from"./index-BYuuB5GE.js";import{b as ie}from"./bookingService-DFeujY8_.js";const de={class:"my-bookings-page"},ce={class:"bookings-content"},ue={class:"filter-tabs"},ve={key:0,class:"loading-state"},pe={key:1,class:"no-project-state"},me={key:2,class:"empty-state"},ke={key:0},he={key:1},ge={key:3,class:"bookings-list"},ye={class:"card-header"},we={key:0,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},fe={key:1,width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},_e={class:"booking-info"},Ce={class:"booking-title"},Be={class:"booking-subtitle"},Ne={class:"header-right"},Se={class:"card-content"},be={class:"details-row"},je={class:"detail-item"},Ae={class:"detail-text"},$e={class:"detail-item"},Me={class:"detail-text"},Pe={class:"detail-item price-item"},Le={class:"detail-text price-text"},Te={key:0,class:"additional-info"},De={key:0,class:"info-tag"},xe={key:1,class:"info-tag"},He={class:"card-footer"},Ue={class:"booking-date"},Ve={class:"card-actions"},Ee=["onClick"],Fe=["onClick"],Ie={class:"modal-body"},Ge={class:"detail-section"},Ze={class:"detail-grid"},ze={class:"detail-item"},Je={class:"value"},Ke={class:"detail-item"},Oe={class:"value"},Re={class:"detail-item"},We={class:"value"},Xe={class:"detail-section"},Ye={class:"detail-grid"},qe={class:"detail-item"},Qe={class:"label"},et={class:"value"},tt={class:"detail-item"},st={class:"label"},ot={class:"value"},at={class:"detail-item"},nt={class:"value"},rt={class:"detail-item"},lt={class:"value"},it={class:"detail-item"},dt={class:"value"},ct={key:0,class:"detail-item"},ut={class:"value"},vt={key:1,class:"detail-item"},pt={class:"value"},mt={key:2,class:"detail-item"},kt={class:"value"},ht={key:3,class:"detail-item"},gt={class:"value"},yt={key:0,class:"detail-section"},wt={class:"detail-grid"},ft={class:"detail-item"},_t={class:"value"},Ct={class:"detail-item"},Bt={class:"value"},Nt={class:"detail-item"},St={class:"value"},bt={class:"detail-item"},jt={class:"value"},At={class:"detail-item"},$t={class:"value"},Mt={key:0,class:"detail-item"},Pt={class:"value"},Lt={class:"modal-footer"},Tt=Object.assign({name:"MyBookingsPage"},{__name:"MyBookings",setup(Dt){const U=X(),k=Y(),b=q(),h=Q(),g=ee(),w=_(!0),C=_(null),u=_("all"),o=_(null),i=N(()=>b.selectedProject?.id),j=N(()=>b.selectedProject?.name),A=N(()=>{const t=[...k.userBookings,...g.getBookings];return u.value==="all"?t:u.value==="court"?t.filter(s=>c(s)):u.value==="academy"?t.filter(s=>p(s)):u.value==="service"?t.filter(s=>$(s)):t}),f=t=>{u.value=t},V=t=>t==="court"?"Court":t==="academy"?"Academy":t==="service"?"Service":"Booking",E=t=>t==="court"?"court-type":t==="academy"?"academy-type":t==="service"?"service-type":"other-type",c=t=>t.type==="court"||t.courtType&&(t.courtLocation||t.bookingTime),p=t=>t.type==="academy"||t.programName&&(t.studentName||t.academyName),$=t=>t.type==="service"||t.serviceName&&t.categoryName&&t.selectedDate,M=t=>({confirmed:"Confirmed",pending:"Pending",cancelled:"Cancelled",completed:"Completed",enrolled:"Enrolled"})[t]||t,P=t=>({confirmed:"confirmed",pending:"pending",cancelled:"cancelled",enrolled:"enrolled",completed:"completed"})[t]||"pending",F=t=>{if(c(t)){const s=t.sport||"Court",a=t.courtName||`${t.courtType} Court`;return`${s} - ${a}`}else return p(t)?t.programName||"Academy Program":"Service Booking"},I=t=>c(t)?"Court Booking":p(t)?`${t.academyName||"Academy"} Program`:"Service",B=t=>{const s=[t.date,t.bookingDate,t.createdAt];for(const a of s)if(a)try{let v;if(a&&typeof a=="object"&&a.seconds?v=new Date(a.seconds*1e3):v=new Date(a),!isNaN(v.getTime()))return v.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}catch(v){console.error("Error formatting booking date:",v,"Date value:",a);continue}return"N/A"},G=t=>{if(!t.createdAt)return"N/A";try{let s;return t.createdAt&&typeof t.createdAt=="object"&&t.createdAt.seconds?s=new Date(t.createdAt.seconds*1e3):s=new Date(t.createdAt),isNaN(s.getTime())?"N/A":s.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch(s){return console.error("Error formatting creation date:",s,"Date value:",t.createdAt),"N/A"}},L=t=>c(t)?t.timeSlots&&Array.isArray(t.timeSlots)?t.timeSlots.join(", "):t.bookingTime?t.bookingTime:"Time not specified":p(t)?"Program Schedule":"N/A",Z=t=>({"per-session":"/session","per-week":"/week","per-month":"/month","per-term":"/term","one-time":" one-time"})[t]||"/month",z=t=>({"per-week":"weeks","per-month":"months","per-term":"terms"})[t]||"months",T=t=>["confirmed","pending","enrolled"].includes(t.status),J=t=>["confirmed","pending","enrolled","open","processing"].includes(t.status),K=t=>{o.value=t},y=()=>{o.value=null},D=async t=>{try{if(confirm("Are you sure you want to cancel this booking?")){await ie.cancelBooking(i.value,t.id);const s=await S.getCurrentUser();s&&i.value&&(await k.fetchUserBookings(s.uid,i.value),await g.fetchUserBookings(i.value,s.uid)),h.showSuccess("Booking cancelled successfully"),y()}}catch(s){console.error("Error cancelling booking:",s),h.showError("Failed to cancel booking. Please try again.")}},O=async t=>{try{if(confirm("Are you sure you want to mark this booking as completed?")){const s=await S.getCurrentUser();if(!s||!i.value){h.showError("Unable to complete booking. Please try again.");return}$(t)?await g.completeBooking(i.value,t.id):await k.completeBooking(i.value,t.id),await k.fetchUserBookings(s.uid,i.value),await g.fetchUserBookings(i.value,s.uid),h.showSuccess("Booking completed successfully"),y()}}catch(s){console.error("Error completing booking:",s),h.showError("Failed to complete booking. Please try again.")}},R=()=>{U.push("/services")};te(async()=>{i.value?await x():(C.value="No project selected. Please select a project first.",w.value=!1)}),se(i,async t=>{t?await x():(k.clearUserBookings(),C.value=null)});const x=async()=>{if(i.value)try{w.value=!0;const t=await S.getCurrentUser();if(!t){C.value="User not authenticated. Please sign in again.";return}console.log("Fetching user bookings for:",{userId:t.uid,projectId:i.value}),await k.fetchUserBookings(t.uid,i.value),await g.fetchUserBookings(i.value,t.uid)}catch(t){console.error("Error fetching user bookings:",t),t.value="Failed to fetch bookings: "+t.message}finally{w.value=!1}};return(t,s)=>(l(),r("div",de,[oe(ae,{title:t.$t("myBookings"),subtitle:j.value?`${t.$t("bookingsIn")} ${j.value}`:t.$t("viewManageBookings")},null,8,["title","subtitle"]),e("div",ce,[e("div",ue,[e("button",{class:m(["filter-tab",{active:u.value==="all"}]),onClick:s[0]||(s[0]=a=>f("all"))},n(t.$t("allBookings")),3),e("button",{class:m(["filter-tab",{active:u.value==="court"}]),onClick:s[1]||(s[1]=a=>f("court"))},n(t.$t("courtBookings")),3),e("button",{class:m(["filter-tab",{active:u.value==="academy"}]),onClick:s[2]||(s[2]=a=>f("academy"))},n(t.$t("academyPrograms")),3),e("button",{class:m(["filter-tab",{active:u.value==="service"}]),onClick:s[3]||(s[3]=a=>f("service"))},n(t.$t("serviceBookings")),3)]),w.value?(l(),r("div",ve,[s[8]||(s[8]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,n(t.$t("loadingBookings")),1)])):i.value?A.value.length===0?(l(),r("div",me,[s[10]||(s[10]=e("div",{class:"empty-icon"},[e("svg",{width:"64",height:"64",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M9 12L11 14L15 10",stroke:"#ccc","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z",stroke:"#ccc","stroke-width":"2"})])],-1)),e("h3",null,n(t.$t("noBookingsFound")),1),u.value==="all"?(l(),r("p",ke,n(t.$t("noBookingsMessage")),1)):(l(),r("p",he,n(t.$t("noBookingsFound")),1)),e("button",{class:"book-now-btn",onClick:R},n(t.$t("bookNow")),1)])):(l(),r("div",ge,[(l(!0),r(ne,null,re(A.value,a=>(l(),r("div",{key:a.id,class:m(["booking-card",P(a.status)])},[e("div",ye,[e("div",{class:m(["booking-icon",E(a.type)])},[c(a)?(l(),r("svg",we,[...s[11]||(s[11]=[H('<path d="M3 3H7V7H3V3Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-d2683274></path><path d="M3 17H7V21H3V17Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-d2683274></path><path d="M17 3H21V7H17V3Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-d2683274></path><path d="M17 17H21V21H17V17Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-d2683274></path><path d="M3 9H7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-d2683274></path><path d="M17 9H21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-d2683274></path><path d="M9 3V7" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-d2683274></path><path d="M9 17V21" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-d2683274></path><path d="M9 9H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-d2683274></path><path d="M9 15H15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-d2683274></path>',10)])])):(l(),r("svg",fe,[...s[12]||(s[12]=[e("path",{d:"M12 2L2 7L12 12L22 7L12 2Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("path",{d:"M2 17L12 22L22 17",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),e("path",{d:"M2 12L12 17L22 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))],2),e("div",_e,[e("h3",Ce,n(F(a)),1),e("p",Be,n(I(a)),1)]),e("div",Ne,[e("span",{class:m(["status-badge",P(a.status)])},n(M(a.status)),3)])]),e("div",Se,[e("div",be,[e("div",je,[s[13]||(s[13]=H('<svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-d2683274><rect x="3" y="4" width="18" height="18" rx="2" ry="2" stroke="currentColor" stroke-width="2" data-v-d2683274></rect><line x1="16" y1="2" x2="16" y2="6" stroke="currentColor" stroke-width="2" data-v-d2683274></line><line x1="8" y1="2" x2="8" y2="6" stroke="currentColor" stroke-width="2" data-v-d2683274></line><line x1="3" y1="10" x2="21" y2="10" stroke="currentColor" stroke-width="2" data-v-d2683274></line></svg>',1)),e("span",Ae,n(B(a)),1)]),e("div",$e,[s[14]||(s[14]=e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2"}),e("polyline",{points:"12,6 12,12 16,14",stroke:"currentColor","stroke-width":"2"})],-1)),e("span",Me,n(L(a)),1)]),e("div",Pe,[s[15]||(s[15]=e("svg",{width:"14",height:"14",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("line",{x1:"12",y1:"1",x2:"12",y2:"23",stroke:"currentColor","stroke-width":"2"}),e("path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",stroke:"currentColor","stroke-width":"2"})],-1)),e("span",Le,n(a.totalPrice||a.price)+" EGP",1)])]),p(a)&&a.studentName||c(a)&&a.courtLocation?(l(),r("div",Te,[p(a)&&a.studentName?(l(),r("span",De," Student: "+n(a.studentName),1)):d("",!0),c(a)&&a.courtLocation?(l(),r("span",xe,n(a.courtLocation),1)):d("",!0)])):d("",!0)]),e("div",He,[e("div",Ue,[s[16]||(s[16]=e("svg",{width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("circle",{cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"2"}),e("polyline",{points:"12,6 12,12 16,14",stroke:"currentColor","stroke-width":"2"})],-1)),e("span",null,n(G(a)),1)]),e("div",Ve,[e("button",{class:"action-btn view-btn",onClick:v=>K(a)}," View ",8,Ee),T(a)?(l(),r("button",{key:0,class:"action-btn cancel-btn",onClick:v=>D(a)}," Cancel ",8,Fe)):d("",!0)])])],2))),128))])):(l(),r("div",pe,[s[9]||(s[9]=e("div",{class:"no-project-icon"},"🏗️",-1)),e("h3",null,n(t.$t("noProjectSelected")),1),e("p",null,n(t.$t("selectProjectToContinue")),1),e("button",{onClick:s[4]||(s[4]=a=>t.$router.push("/project-selection")),class:"select-project-btn"},n(t.$t("switchProject")),1)]))]),o.value?(l(),r("div",{key:0,class:"modal-overlay",onClick:y},[e("div",{class:"modal-content",onClick:s[7]||(s[7]=le(()=>{},["stop"]))},[e("div",{class:"modal-header"},[s[18]||(s[18]=e("h2",null,"Booking Details",-1)),e("button",{class:"close-btn",onClick:y},[...s[17]||(s[17]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M18 6L6 18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M6 6L18 18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])]),e("div",Ie,[e("div",Ge,[s[22]||(s[22]=e("h3",null,"Booking Information",-1)),e("div",Ze,[e("div",ze,[s[19]||(s[19]=e("span",{class:"label"},"Type:",-1)),e("span",Je,n(V(o.value.type)),1)]),e("div",Ke,[s[20]||(s[20]=e("span",{class:"label"},"Status:",-1)),e("span",Oe,n(M(o.value.status)),1)]),e("div",Re,[s[21]||(s[21]=e("span",{class:"label"},"Created:",-1)),e("span",We,n(B(o.value)),1)])])]),e("div",Xe,[e("h3",null,n(c(o.value)?"Court Details":"Program Details"),1),e("div",Ye,[e("div",qe,[e("span",Qe,n(c(o.value)?"Sport:":"Program:"),1),e("span",et,n(c(o.value)?o.value.sport||"Court Sport":o.value.programName),1)]),e("div",tt,[e("span",st,n(c(o.value)?"Court:":"Academy:"),1),e("span",ot,n(c(o.value)?o.value.courtName||`${o.value.courtType} Court`:o.value.academyName),1)]),e("div",at,[s[23]||(s[23]=e("span",{class:"label"},"Date:",-1)),e("span",nt,n(B(o.value)),1)]),e("div",rt,[s[24]||(s[24]=e("span",{class:"label"},"Time:",-1)),e("span",lt,n(L(o.value)),1)]),e("div",it,[s[25]||(s[25]=e("span",{class:"label"},"Price:",-1)),e("span",dt,n(o.value.totalPrice||o.value.price)+" EGP",1)]),o.value.type==="academy"&&o.value.category?(l(),r("div",ct,[s[26]||(s[26]=e("span",{class:"label"},"Category:",-1)),e("span",ut,n(o.value.category),1)])):d("",!0),o.value.type==="academy"&&o.value.ageGroup?(l(),r("div",vt,[s[27]||(s[27]=e("span",{class:"label"},"Age Group:",-1)),e("span",pt,n(o.value.ageGroup),1)])):d("",!0),o.value.type==="academy"&&o.value.duration?(l(),r("div",mt,[s[28]||(s[28]=e("span",{class:"label"},"Duration:",-1)),e("span",kt,n(o.value.duration)+" "+n(z(o.value.pricingType)),1)])):d("",!0),o.value.type==="academy"&&o.value.pricingType?(l(),r("div",ht,[s[29]||(s[29]=e("span",{class:"label"},"Pricing:",-1)),e("span",gt,n(Z(o.value.pricingType)),1)])):d("",!0)])]),p(o.value)?(l(),r("div",yt,[s[36]||(s[36]=e("h3",null,"Student Information",-1)),e("div",wt,[e("div",ft,[s[30]||(s[30]=e("span",{class:"label"},"Student Name:",-1)),e("span",_t,n(o.value.studentName||"N/A"),1)]),e("div",Ct,[s[31]||(s[31]=e("span",{class:"label"},"Student Age:",-1)),e("span",Bt,n(o.value.studentAge||"N/A"),1)]),e("div",Nt,[s[32]||(s[32]=e("span",{class:"label"},"Parent/Guardian:",-1)),e("span",St,n(o.value.parentName||"N/A"),1)]),e("div",bt,[s[33]||(s[33]=e("span",{class:"label"},"Phone:",-1)),e("span",jt,n(o.value.phone||"N/A"),1)]),e("div",At,[s[34]||(s[34]=e("span",{class:"label"},"Email:",-1)),e("span",$t,n(o.value.email||"N/A"),1)]),o.value.notes?(l(),r("div",Mt,[s[35]||(s[35]=e("span",{class:"label"},"Notes:",-1)),e("span",Pt,n(o.value.notes),1)])):d("",!0)])])):d("",!0)]),e("div",Lt,[J(o.value)?(l(),r("button",{key:0,class:"complete-booking-btn",onClick:s[5]||(s[5]=a=>O(o.value))}," Complete Booking ")):d("",!0),T(o.value)?(l(),r("button",{key:1,class:"cancel-booking-btn",onClick:s[6]||(s[6]=a=>D(o.value))}," Cancel Booking ")):d("",!0),e("button",{class:"close-modal-btn",onClick:y}," Close ")])])])):d("",!0)]))}}),Ut=W(Tt,[["__scopeId","data-v-d2683274"]]);export{Ut as default};
