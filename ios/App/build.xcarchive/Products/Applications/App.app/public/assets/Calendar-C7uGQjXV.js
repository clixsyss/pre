import{aC as I,aD as ee,b1 as te,u as ne,b2 as oe,r as E,c as y,aE as se,az as re,aG as r,aH as a,aS as ae,aI as o,aT as le,aN as w,aJ as c,aK as f,aL as k,aM as j}from"./index-BYuuB5GE.js";const ie={class:"calendar-page"},ce={class:"calendar-content"},de={class:"calendar-navigation"},ue={class:"nav-controls"},ve={class:"month-display"},ge={class:"current-month"},he={class:"calendar-container"},me={class:"calendar-header"},pe={class:"calendar-grid"},ye=["onClick"],De={class:"date-number"},we={key:0,class:"event-indicator"},fe={key:1,class:"event-count"},ke={key:0,class:"events-section"},_e={class:"section-header"},Ce={key:0,class:"events-list"},Se=["onClick"],Me={key:0,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},Ee={key:1,width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},je={class:"event-info"},Te={class:"event-title"},Be={class:"event-details"},Pe={class:"event-time"},Le={key:0,class:"event-location"},Ne={class:"event-status"},xe={key:1,class:"no-events"},be={class:"upcoming-events-section"},$e={key:0,class:"upcoming-events-list"},Ue=["onClick"],ze={class:"event-date"},Fe={class:"date-day"},Ae={class:"date-month"},Ve={class:"event-content"},Oe={class:"event-title"},Ye={class:"event-type"},He={key:1,class:"no-upcoming-events"},Ge=Object.assign({name:"CalendarPage"},{__name:"Calendar",setup(Je){const _=ee(),C=te(),v=ne(),S=oe(),p=e=>{if(!e)return null;let t;if(typeof e=="string")if(e.includes("T")){const n=e.split("T")[0],[l,s,i]=n.split("-").map(Number);t=new Date(l,s-1,i)}else{const[n,l,s]=e.split("-").map(Number);t=new Date(n,l-1,s)}else if(e instanceof Date)t=new Date(e.getFullYear(),e.getMonth(),e.getDate());else return null;return isNaN(t.getTime())?(console.warn("Invalid date input:",e),null):t},g=e=>{if(!e)return null;const t=p(e);if(!t)return null;const n=t.getFullYear(),l=String(t.getMonth()+1).padStart(2,"0"),s=String(t.getDate()).padStart(2,"0");return`${n}-${l}-${s}`},u=E(new Date),h=E(null),D=E(null),N=y(()=>u.value.toLocaleDateString("en-US",{month:"long",year:"numeric"})),x=y(()=>["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]),b=y(()=>{const e=u.value.getFullYear(),t=u.value.getMonth(),n=new Date(e,t,1),l=new Date(n);l.setDate(l.getDate()-n.getDay());const s=[],i=new Date;for(let d=0;d<42;d++){const m=new Date(l);m.setDate(l.getDate()+d);const Z=m.getMonth()===t,q=m.toDateString()===i.toDateString(),L=B(m),Q=L.length>0,X=L.length;s.push({key:m.toISOString(),day:m.getDate(),date:m,isCurrentMonth:Z,isToday:q,hasEvents:Q,eventCount:X})}return s}),T=y(()=>h.value?B(h.value):[]),M=y(()=>{if(!D.value||!v.selectedProject)return[];const e=C.userBookings,t=S.getCalendarBookings;console.log("ðŸ“… Calendar Debug - Current user bookings:",e),console.log("ðŸ“… Calendar Debug - Service bookings:",t),console.log("ðŸ“… Calendar Debug - User bookings count:",e?.length||0),console.log("ðŸ“… Calendar Debug - Service bookings count:",t?.length||0);const n=[];e.forEach(s=>{if(s.type==="court"&&s.date){const i=p(s.date);if(!i){console.warn("Invalid date for booking:",s);return}const d=g(i);console.log("Processing court booking:",{originalDate:s.date,normalizedDate:i,formattedDate:d}),n.push({id:s.id,title:`${s.sport||"Court"} - ${s.courtName||"Court"}`,date:d,type:"court",status:s.status,timeSlots:s.timeSlots,location:s.courtName||"Court"})}}),e.forEach(s=>{if(s.type==="academy"&&s.status==="enrolled"){let i;if(s.date){const d=p(s.date);i=g(d||new Date)}else i=g(new Date);n.push({id:s.id,title:s.programName||"Academy Program",date:i,type:"academy",status:s.status,location:s.academyName||"Academy"})}}),t.forEach(s=>{if(s.selectedDate){const i=p(s.selectedDate);if(!i){console.warn("Invalid date for service booking:",s);return}const d=g(i);console.log("Processing service booking:",{originalDate:s.selectedDate,normalizedDate:i,formattedDate:d}),n.push({id:s.id,title:`${s.serviceName} - ${s.categoryName}`,date:d,type:"service",status:s.status,price:s.servicePrice,location:s.categoryName||"Service"})}}),console.log("ðŸ“… Calendar Debug - Processed events:",n),console.log("ðŸ“… Calendar Debug - Total events count:",n.length);const l=n.sort((s,i)=>new Date(s.date)-new Date(i.date));return console.log("ðŸ“… Calendar Debug - Sorted events:",l),l}),B=e=>{if(!D.value||!v.selectedProject)return[];const t=p(e);if(!t)return[];const n=g(t);return console.log("Checking for events on date:",n,"Original date:",e),M.value.filter(l=>{const s=g(l.date);return console.log("Comparing event date:",s,"with selected date:",n),s===n})},$=e=>{h.value=e},U=()=>{u.value=new Date(u.value.getFullYear(),u.value.getMonth()-1,1)},z=()=>{u.value=new Date(u.value.getFullYear(),u.value.getMonth()+1,1)},F=()=>{u.value=new Date},A=e=>e.toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"}),V=e=>e?new Date(e).getDate():"Ongoing",O=e=>e?new Date(e).toLocaleDateString("en-US",{month:"short"}):"Ongoing",Y=e=>e.type==="court"&&e.timeSlots?e.timeSlots.join(", "):"All day",H=e=>e==="court"?"Court Booking":"Academy Program",G=e=>e==="court"?"court-event":"academy-event",J=e=>({confirmed:"Confirmed",pending:"Pending",cancelled:"Cancelled",enrolled:"Enrolled"})[e]||e,K=e=>({confirmed:"confirmed",pending:"pending",cancelled:"cancelled",enrolled:"enrolled"})[e]||"pending",P=()=>{_.push("/my-bookings")},R=e=>{const t=e.currentTarget;t&&t.style&&(t.style.backgroundColor="#f0f0f0")},W=e=>{const t=e.currentTarget;t&&t.style&&setTimeout(()=>{t.style.backgroundColor=""},150)};return se(async()=>{const e=re.currentUser;if(e){if(D.value=e,!v.hasSelectedProject&&(v.loadSelectedProject(),!v.hasSelectedProject)){_.push("/project-selection");return}try{await C.fetchUserBookings(e.uid,v.selectedProject.id),console.log("User bookings fetched:",C.userBookings),await S.fetchUserBookings(v.selectedProject.id,e.uid),console.log("Service bookings fetched:",S.getBookings),console.log("Current project:",v.selectedProject)}catch(t){console.error("Error fetching user bookings:",t)}}else D.value=null,_.push("/login")}),(e,t)=>(a(),r("div",ie,[ae(le,{title:e.$t("calendar"),subtitle:e.$t("viewEvents")},null,8,["title","subtitle"]),o("div",ce,[o("div",de,[o("div",ue,[o("button",{class:"nav-btn",onClick:U},[...t[1]||(t[1]=[o("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M15 18L9 12L15 6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])]),o("div",ve,[o("h2",ge,c(N.value),1),o("button",{class:"today-btn",onClick:F},"Today")]),o("button",{class:"nav-btn",onClick:z},[...t[2]||(t[2]=[o("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M9 18L15 12L9 6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])])]),o("div",he,[o("div",me,[(a(!0),r(f,null,k(x.value,n=>(a(),r("div",{class:"day-header",key:n},c(n),1))),128))]),o("div",pe,[(a(!0),r(f,null,k(b.value,n=>(a(),r("div",{key:n.key,class:j(["date-cell",{"other-month":!n.isCurrentMonth,today:n.isToday,"has-events":n.hasEvents,selected:h.value?.toDateString()===n.date.toDateString()}]),onClick:l=>$(n.date),onTouchstart:R,onTouchend:W},[o("span",De,c(n.day),1),n.hasEvents?(a(),r("div",we)):w("",!0),n.eventCount>1?(a(),r("div",fe,c(n.eventCount),1)):w("",!0)],42,ye))),128))])]),h.value?(a(),r("div",ke,[o("div",_e,[o("h3",null,"Events for "+c(A(h.value)),1),o("button",{class:"clear-selection",onClick:t[0]||(t[0]=n=>h.value=null)},[...t[3]||(t[3]=[o("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M18 6L6 18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),o("path",{d:"M6 6L18 18",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])])]),T.value.length>0?(a(),r("div",Ce,[(a(!0),r(f,null,k(T.value,n=>(a(),r("div",{key:n.id,class:"event-card",onClick:l=>P()},[o("div",{class:j(["event-icon",G(n.type)])},[n.type==="court"?(a(),r("svg",Me,[...t[4]||(t[4]=[o("path",{d:"M3 9L12 2L21 9V20C21 20.5304 20.7893 21.0391 20.4142 21.4142C20.0391 21.7893 19.5304 22 19 22H5C4.46957 22 3.96086 21.7893 3.58579 21.4142C3.21071 21.0391 3 20.5304 3 20V9Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),o("polyline",{points:"9,22 9,12 15,12 15,22",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])])):(a(),r("svg",Ee,[...t[5]||(t[5]=[o("path",{d:"M16 21V19C16 17.9391 15.5786 16.9217 14.8284 16.1716C14.0783 15.4214 13.0609 15 12 15C10.9391 15 9.92172 15.4214 9.17157 16.1716C8.42143 16.9217 8 17.9391 8 19V21",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1),o("circle",{cx:"12",cy:"7",r:"4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},null,-1)])]))],2),o("div",je,[o("div",Te,c(n.title),1),o("div",Be,[o("span",Pe,c(Y(n)),1),n.location?(a(),r("span",Le,c(n.location),1)):w("",!0)])]),o("div",Ne,[o("span",{class:j(["status-badge",K(n.status)])},c(J(n.status)),3)])],8,Se))),128))])):(a(),r("div",xe,[...t[6]||(t[6]=[o("p",null,"No events scheduled for this date",-1)])]))])):w("",!0),o("div",be,[t[9]||(t[9]=o("h3",null,"All Upcoming Events",-1)),M.value.length>0?(a(),r("div",$e,[(a(!0),r(f,null,k(M.value,n=>(a(),r("div",{key:n.id,class:"upcoming-event-item",onClick:l=>P()},[o("div",ze,[o("div",Fe,c(V(n.date)),1),o("div",Ae,c(O(n.date)),1)]),o("div",Ve,[o("div",Oe,c(n.title),1),o("div",Ye,c(H(n.type)),1)]),t[7]||(t[7]=o("div",{class:"event-arrow"},[o("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[o("path",{d:"M9 18L15 12L9 6",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1))],8,Ue))),128))])):(a(),r("div",He,[...t[8]||(t[8]=[o("p",null,"No upcoming events",-1)])]))])])]))}}),Re=I(Ge,[["__scopeId","data-v-4769352d"]]);export{Re as default};
