import{aC as J,aR as K,bj as Q,aY as W,u as Y,c as m,r as w,aF as D,aE as q,bk as U,aG as r,aH as i,aS as X,b5 as ee,aI as e,aT as te,aJ as a,aN as d,aO as M,aK as F,aL as L,aM as h,aW as N,aQ as P}from"./index-BYuuB5GE.js";const se={class:"smart-devices-page"},oe=["disabled"],ne={key:0,class:"not-connected-state"},ae={key:1,class:"loading-state"},re={key:2,class:"devices-content"},ie={key:0,class:"room-selector"},le={class:"room-selector-header"},de={class:"room-count"},ce={class:"room-tabs"},ue=["onClick"],ve={class:"room-tab-content"},he={class:"room-name"},ge={class:"room-device-count"},pe={class:"devices-sections"},_e={key:0,class:"devices-section"},ke={class:"section-header"},me={class:"section-title"},we={class:"section-text"},fe={class:"device-count"},ye={class:"devices-grid"},Ce={class:"device-header"},be={class:"device-info"},je={class:"device-name"},De={class:"device-room"},Fe={class:"status-text"},Le={class:"device-controls"},Se={class:"toggle-switch-container"},Me={class:"toggle-switch"},Pe=["checked","disabled","onChange"],Ie={class:"toggle-slider"},xe={key:0,class:"loading-spinner-small"},Ne={class:"toggle-label"},Ee={key:0,class:"brightness-control"},$e={class:"control-header"},Oe={class:"brightness-value"},Ve=["value","onInput"],Ae={key:1,class:"devices-section"},Be={class:"section-header"},He={class:"section-title"},Te={class:"section-text"},Re={class:"device-count"},ze={class:"devices-grid"},Ze={class:"device-header"},Ge={class:"device-info"},Je={class:"device-name"},Ke={class:"device-room"},Qe={class:"status-text"},We={class:"device-controls"},Ye={class:"toggle-switch-container"},qe={class:"toggle-switch"},Ue=["checked","disabled","onChange"],Xe={class:"toggle-slider"},et={key:0,class:"loading-spinner-small"},tt={class:"toggle-label"},st={key:0,class:"climate-controls"},ot={class:"temperature-control"},nt={class:"control-header"},at={class:"temperature-value"},rt=["value","onInput"],it={class:"mode-control"},lt=["value","onChange"],dt={key:2,class:"devices-section"},ct={class:"section-header"},ut={class:"section-title"},vt={class:"section-text"},ht={class:"device-count"},gt={class:"devices-grid"},pt={class:"device-header"},_t={class:"device-info"},kt={class:"device-name"},mt={class:"device-room"},wt={class:"status-text"},ft={class:"device-controls"},yt={class:"toggle-switch-container"},Ct={class:"toggle-switch"},bt=["checked","disabled","onChange"],jt={class:"toggle-slider"},Dt={key:0,class:"loading-spinner-small"},Ft={class:"toggle-label"},Lt={key:3,class:"no-devices-state"},St=Object.assign({name:"SmartDevicesPage"},{__name:"SmartDevices",setup(Mt){const I=K(),n=Q(),l=W(),u=Y(),x=m(()=>{const s=u.selectedProject?.id;return s?n.devices.length>0&&n.currentProjectId===s:!1}),v=w(!1),g=w(null),f=w(null),y=w(null),C=w(null),b=m(()=>g.value?n.getRoomDevices(g.value):n.devices),p=m(()=>b.value.filter(s=>s.type==="light")),_=m(()=>b.value.filter(s=>s.type==="thermostat"||s.type==="climate"||s.type==="fan"||s.type==="heater"||s.type==="ac"||s.type==="air_conditioner"||s.type==="air-conditioner")),k=m(()=>b.value.filter(s=>s.type==="plug"||s.type==="outlet"||s.type==="switch"||s.type==="sensor"||s.type==="camera"||s.type==="door"||s.type==="window")),E=s=>{g.value=s,n.selectRoom(s)},$=s=>n.getRoomDevices(s).length,O=async()=>{const s=p.value.every(t=>t.state),o=p.value.map(t=>n.toggleLight(t.roomId,t.id,!s));await Promise.all(o)},V=async()=>{const s=_.value.every(t=>t.state),o=_.value.map(t=>n.setClimateState(t.roomId,t.id,!s));await Promise.all(o)},A=async()=>{const s=k.value.every(t=>t.state),o=k.value.map(t=>n.toggleLight(t.roomId,t.id,!s));await Promise.all(o)},B=async s=>{f.value=s.id;try{const o=await n.toggleLight(s.roomId,s.id,!s.state);o.success?l.showSuccess(`Light ${s.state?"turned off":"turned on"}`):l.showError(o.error||"Failed to control light")}catch{l.showError("Failed to control light")}finally{f.value=null}},H=async(s,o)=>{try{const t=await n.setLightBrightness(s.roomId,s.id,parseInt(o));t.success||l.showError(t.error||"Failed to set brightness")}catch{l.showError("Failed to set brightness")}},T=async s=>{y.value=s.id;try{const o=await n.setClimateState(s.roomId,s.id,!s.state);o.success?l.showSuccess(`Climate control ${s.state?"turned off":"turned on"}`):l.showError(o.error||"Failed to control climate")}catch{l.showError("Failed to control climate")}finally{y.value=null}},R=async(s,o)=>{try{const t=await n.setClimateTemperature(s.roomId,s.id,parseInt(o));t.success||l.showError(t.error||"Failed to set temperature")}catch{l.showError("Failed to set temperature")}},z=async(s,o)=>{try{const t=await n.setClimateMode(s.roomId,s.id,o);t.success?l.showSuccess(`Mode changed to ${o}`):l.showError(t.error||"Failed to change mode")}catch{l.showError("Failed to change mode")}},Z=async s=>{C.value=s.id;try{const o=await n.toggleLight(s.roomId,s.id,!s.state);o.success?l.showSuccess(`Plug ${s.state?"turned off":"turned on"}`):l.showError(o.error||"Failed to control plug")}catch{l.showError("Failed to control plug")}finally{C.value=null}},G=async()=>{v.value=!0;try{await j(),l.showSuccess("Devices refreshed successfully")}catch(s){console.error("Error refreshing devices:",s),l.showError("Failed to refresh devices")}finally{v.value=!1}},S=async()=>{const s=u.selectedProject?.id;if(console.log("SmartDevices: Loading devices for project:",s),console.log("SmartDevices: Current project ID in store:",n.currentProjectId),console.log("SmartDevices: Devices count:",n.devices.length),console.log("SmartDevices: Is connected:",n.isConnected),n.devices.length>0&&n.currentProjectId===s){v.value=!0;try{n.rooms.length>0&&(g.value=n.rooms[0].id),console.log("SmartDevices: Devices loaded successfully:",n.devices.length)}catch(t){console.error("SmartDevices: Error loading devices:",t),l.showError("Failed to load devices")}finally{v.value=!1}}else g.value=null,v.value=!1,console.log("SmartDevices: No devices available for current project")},j=async()=>{if(u.selectedProject)try{u.selectedProject?.id&&(console.log("SmartDevices: Switching to project:",u.selectedProject.id),await n.switchToProject(u.selectedProject.id),await S())}catch(s){console.error("Error switching to selected project:",s)}};return D(()=>u.selectedProject,async(s,o)=>{s&&s.id!==o?.id&&await S()},{immediate:!0}),D(()=>n.devices,()=>{},{deep:!0}),D(()=>n.currentProjectId,async(s,o)=>{s&&s!==o&&await S()},{immediate:!0}),q(async()=>{await n.initializeApp(),await j()}),D(()=>I.path,async()=>{I.path==="/smart-devices"&&await j()}),U(async()=>{await j()}),(s,o)=>(i(),r("div",se,[X(te,{title:s.$t("smartDevicesTitle"),subtitle:x.value?s.$t("connected").toLowerCase():s.$t("notConnected")},{actions:ee(()=>[e("button",{class:"refresh-button",onClick:G,disabled:v.value},[...o[1]||(o[1]=[e("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M3 12A9 9 0 0 1 12 3A9 9 0 0 1 21 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M21 12A9 9 0 0 1 12 21A9 9 0 0 1 3 12",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M12 3V12L16.5 7.5",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)])],8,oe)]),_:1},8,["title","subtitle"]),x.value?v.value?(i(),r("div",ae,[o[3]||(o[3]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,a(s.$t("loadingDevices")),1)])):(i(),r("div",re,[M(n).rooms.length>1?(i(),r("div",ie,[e("div",le,[e("h3",null,a(s.$t("selectRoom")),1),e("span",de,a(M(n).rooms.length)+" rooms available",1)]),e("div",ce,[(i(!0),r(F,null,L(M(n).rooms,t=>(i(),r("button",{key:t.id,class:h(["room-tab",{active:g.value===t.id}]),onClick:c=>E(t.id)},[e("div",ve,[e("span",he,a(t.name),1),e("span",ge,a($(t.id))+" devices",1)])],10,ue))),128))])])):d("",!0),e("div",pe,[p.value.length>0?(i(),r("div",_e,[e("div",ke,[e("div",me,[o[5]||(o[5]=N('<div class="section-icon lights-icon" data-v-1b27dd33><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-1b27dd33><path d="M9 21C9 21.5523 9.44772 22 10 22H14C14.5523 22 15 21.5523 15 21V20H9V21Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-1b27dd33></path><path d="M12 2V4" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-1b27dd33></path><path d="M12 18C15.3137 18 18 15.3137 18 12C18 8.68629 15.3137 6 12 6C8.68629 6 6 8.68629 6 12C6 15.3137 8.68629 18 12 18Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-1b27dd33></path></svg></div>',1)),e("div",we,[o[4]||(o[4]=e("h3",null,"Lights",-1)),e("span",fe,a(p.value.length)+" device"+a(p.value.length!==1?"s":""),1)])]),e("div",{class:"section-actions"},[e("button",{class:"action-btn",onClick:O},[...o[6]||(o[6]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M9 12L11 14L15 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),P(" Toggle All ",-1)])])])]),e("div",ye,[(i(!0),r(F,null,L(p.value,t=>(i(),r("div",{key:t.id,class:h(["device-card light-card",{"device-on":t.state,"device-off":!t.state}])},[e("div",Ce,[e("div",be,[e("h4",je,a(t.name),1),e("span",De,a(t.roomName),1)]),e("div",{class:h(["device-status",{on:t.state,off:!t.state}])},[o[7]||(o[7]=e("div",{class:"status-indicator"},null,-1)),e("span",Fe,a(t.state?"ON":"OFF"),1)],2)]),e("div",Le,[e("div",Se,[e("label",Me,[e("input",{type:"checkbox",checked:t.state,disabled:f.value===t.id,onChange:c=>B(t)},null,40,Pe),e("span",Ie,[f.value===t.id?(i(),r("div",xe)):d("",!0)])]),e("span",Ne,a(t.state?"ON":"OFF"),1)]),t.state?(i(),r("div",Ee,[e("div",$e,[o[8]||(o[8]=e("label",null,"Brightness",-1)),e("span",Oe,a(t.brightness||0)+"%",1)]),e("input",{type:"range",value:t.brightness||0,onInput:c=>H(t,c.target.value),min:"0",max:"100",class:"brightness-slider"},null,40,Ve)])):d("",!0)])],2))),128))])])):d("",!0),_.value.length>0?(i(),r("div",Ae,[e("div",Be,[e("div",He,[o[10]||(o[10]=e("div",{class:"section-icon climate-icon"},[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M14 4V10.54C14 11.5 14.5 12.4 15.3 12.9L16.7 13.8C17.5 14.3 18 15.2 18 16.2V17C18 18.1 17.1 19 16 19H8C6.9 19 6 18.1 6 17V16.2C6 15.2 6.5 14.3 7.3 13.8L8.7 12.9C9.5 12.4 10 11.5 10 10.5V4",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"}),e("path",{d:"M10 4H14",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})])],-1)),e("div",Te,[o[9]||(o[9]=e("h3",null,"Climate Control",-1)),e("span",Re,a(_.value.length)+" device"+a(_.value.length!==1?"s":""),1)])]),e("div",{class:"section-actions"},[e("button",{class:"action-btn",onClick:V},[...o[11]||(o[11]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M9 12L11 14L15 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),P(" Toggle All ",-1)])])])]),e("div",ze,[(i(!0),r(F,null,L(_.value,t=>(i(),r("div",{key:t.id,class:h(["device-card climate-card",{"device-on":t.state,"device-off":!t.state}])},[e("div",Ze,[e("div",Ge,[e("h4",Je,a(t.name),1),e("span",Ke,a(t.roomName),1)]),e("div",{class:h(["device-status",{on:t.state,off:!t.state}])},[o[12]||(o[12]=e("div",{class:"status-indicator"},null,-1)),e("span",Qe,a(t.state?"ON":"OFF"),1)],2)]),e("div",We,[e("div",Ye,[e("label",qe,[e("input",{type:"checkbox",checked:t.state,disabled:y.value===t.id,onChange:c=>T(t)},null,40,Ue),e("span",Xe,[y.value===t.id?(i(),r("div",et)):d("",!0)])]),e("span",tt,a(t.state?"ON":"OFF"),1)]),t.state?(i(),r("div",st,[e("div",ot,[e("div",nt,[o[13]||(o[13]=e("label",null,"Temperature",-1)),e("span",at,a(t.temperature||22)+"°C",1)]),e("input",{type:"range",value:t.temperature||22,onInput:c=>R(t,c.target.value),min:"16",max:"30",class:"temperature-slider"},null,40,rt)]),e("div",it,[o[15]||(o[15]=e("label",null,"Mode",-1)),e("select",{value:t.mode||"heat",onChange:c=>z(t,c.target.value),class:"mode-select"},[...o[14]||(o[14]=[e("option",{value:"heat"},"Heat",-1),e("option",{value:"cool"},"Cool",-1),e("option",{value:"auto"},"Auto",-1),e("option",{value:"fan"},"Fan",-1)])],40,lt)])])):d("",!0)])],2))),128))])])):d("",!0),k.value.length>0?(i(),r("div",dt,[e("div",ct,[e("div",ut,[o[17]||(o[17]=N('<div class="section-icon plugs-icon" data-v-1b27dd33><svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" data-v-1b27dd33><path d="M12 2V6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-1b27dd33></path><path d="M12 18V22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-1b27dd33></path><path d="M4.93 4.93L7.76 7.76" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-1b27dd33></path><path d="M16.24 16.24L19.07 19.07" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-1b27dd33></path><path d="M2 12H6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-1b27dd33></path><path d="M18 12H22" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-1b27dd33></path><path d="M4.93 19.07L7.76 16.24" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-1b27dd33></path><path d="M16.24 7.76L19.07 4.93" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-v-1b27dd33></path></svg></div>',1)),e("div",vt,[o[16]||(o[16]=e("h3",null,"Smart Plugs",-1)),e("span",ht,a(k.value.length)+" device"+a(k.value.length!==1?"s":""),1)])]),e("div",{class:"section-actions"},[e("button",{class:"action-btn",onClick:A},[...o[18]||(o[18]=[e("svg",{width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M9 12L11 14L15 10",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1),P(" Toggle All ",-1)])])])]),e("div",gt,[(i(!0),r(F,null,L(k.value,t=>(i(),r("div",{key:t.id,class:h(["device-card plug-card",{"device-on":t.state,"device-off":!t.state}])},[e("div",pt,[e("div",_t,[e("h4",kt,a(t.name),1),e("span",mt,a(t.roomName),1)]),e("div",{class:h(["device-status",{on:t.state,off:!t.state}])},[o[19]||(o[19]=e("div",{class:"status-indicator"},null,-1)),e("span",wt,a(t.state?"ON":"OFF"),1)],2)]),e("div",ft,[e("div",yt,[e("label",Ct,[e("input",{type:"checkbox",checked:t.state,disabled:C.value===t.id,onChange:c=>Z(t)},null,40,bt),e("span",jt,[C.value===t.id?(i(),r("div",Dt)):d("",!0)])]),e("span",Ft,a(t.state?"ON":"OFF"),1)])])],2))),128))])])):d("",!0),b.value.length===0?(i(),r("div",Lt,[...o[20]||(o[20]=[e("div",{class:"no-devices-icon"},"🔌",-1),e("h3",null,"No Devices Found",-1),e("p",null,"No devices are available in this room.",-1)])])):d("",!0)])])):(i(),r("div",ne,[o[2]||(o[2]=e("div",{class:"not-connected-icon"},"🏠",-1)),e("h3",null,a(s.$t("smartHomeNotConnected")),1),e("p",null,a(s.$t("connectSmartHomeMessage")),1),e("button",{onClick:o[0]||(o[0]=t=>s.$router.push("/profile")),class:"connect-btn"},a(s.$t("goToProfile")),1)]))]))}}),It=J(St,[["__scopeId","data-v-1b27dd33"]]);export{It as default};
