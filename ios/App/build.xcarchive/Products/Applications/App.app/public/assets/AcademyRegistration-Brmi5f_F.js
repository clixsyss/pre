import{aC as j,aD as E,aR as G,b1 as M,u as O,r as d,c as N,aE as B,aG as i,aH as u,aS as F,aN as h,aT as H,aI as e,aJ as s,aX as W,aU as p,aV as v,aQ as _,o as z,s as D,f as J}from"./index-BYuuB5GE.js";const Q={class:"academy-registration-page"},X={key:0,class:"loading-state"},K={key:1,class:"error-state"},L={key:2,class:"registration-content"},Y={class:"program-summary-modern"},Z={class:"summary-hero"},x={class:"hero-left"},ee={class:"program-badge"},te={class:"academy-tag"},ae={class:"price-hero"},se={class:"total-price"},oe={class:"summary-pills"},re={key:0,class:"sum-pill"},ne={key:1,class:"sum-pill"},le={key:2,class:"sum-pill"},ie={class:"registration-form"},ue={class:"section-title"},de={class:"form-group"},ce={for:"studentName"},me=["placeholder"],pe={class:"form-group"},ve={for:"studentAge"},ge=["placeholder"],fe={class:"form-group"},ye={for:"parentName"},he=["placeholder"],_e={class:"form-group"},be={for:"phone"},Ne=["placeholder"],$e={class:"form-group"},Ae={for:"email"},ke=["placeholder"],Pe={class:"form-group"},Te={for:"notes"},Ie=["placeholder"],Se={class:"form-actions"},we=["disabled"],De=["disabled"],Re={key:0},qe={class:"button-loading"},Ve={key:1},Ce={key:0,class:"success-message"},Ue={class:"registration-details"},je={class:"redirect-notice"},Ee=Object.assign({name:"AcademyRegistrationPage"},{__name:"AcademyRegistration",setup(Ge){const R=E(),k=G(),g=M(),q=O(),$=d(!1),l=d(null),f=d(!1),P=d(!1),T=d(null),c=d(null),a=d(null),r=d({studentName:"",studentAge:"",parentName:"",phone:"",email:"",notes:""}),m=N(()=>q.selectedProject),A=N(()=>k.params.academyId),b=N(()=>k.params.programId),I=N(()=>a.value?.price?a.value.pricingType==="one-time"||a.value.pricingType==="per-session"?a.value.price:a.value.duration&&(a.value.pricingType==="per-week"||a.value.pricingType==="per-month"||a.value.pricingType==="per-term")?a.value.price*a.value.duration:a.value.price:0),S=async()=>{if(!m.value?.id||!A.value||!b.value){l.value="Missing required information";return}$.value=!0,l.value=null;try{(!g.academyOptions||g.academyOptions.length===0)&&await g.fetchAcademies(m.value.id);const t=g.academyOptions.find(o=>o.id===A.value);if(t){c.value=t;const o=t.programs?.find(n=>n.id===b.value||n.name===b.value);o?a.value=o:l.value="Program not found"}else l.value="Academy not found"}catch(t){console.error("Error loading program details:",t),l.value="Failed to load program details. Please try again."}finally{$.value=!1}},V=async()=>{if(!c.value||!a.value||!m.value?.id){l.value="Missing required information";return}if(!r.value.studentName.trim()){l.value="Student name is required";return}if(!r.value.studentAge||r.value.studentAge<3||r.value.studentAge>100){l.value="Please enter a valid student age (3-100)";return}if(!r.value.parentName.trim()){l.value="Parent/Guardian name is required";return}if(!r.value.phone.trim()){l.value="Phone number is required";return}f.value=!0,l.value=null;try{const t=await z.getCurrentUser();if(!t){l.value="Please log in to register for academy programs.";return}const o={userId:t.uid,projectId:m.value.id,academyId:c.value.id,academyName:c.value.name,programId:a.value.id,programName:a.value.name,type:"academy",status:"pending",studentName:r.value.studentName,studentAge:parseInt(r.value.studentAge),parentName:r.value.parentName,phone:r.value.phone,email:r.value.email,notes:r.value.notes,category:a.value.category||"Sports",ageGroup:a.value.ageGroup,duration:a.value.duration,pricingType:a.value.pricingType,price:a.value.price,totalCost:I.value,createdAt:D(),updatedAt:D()},n=`projects/${m.value.id}/bookings`,y=await J.addDoc(n,o);console.log("🔍 Academy registration addDoc result:",y);const w=y.id||y.documentId||y;if(!w)throw console.error("❌ No booking ID returned from addDoc:",y),new Error("Failed to create academy registration - no ID returned");await new Promise(U=>setTimeout(U,500)),await g.fetchUserBookings(t.uid,m.value.id),T.value=w,P.value=!0,setTimeout(()=>{R.push("/academy-programs")},2500)}catch(t){console.error("Error submitting registration:",t),l.value="Failed to submit registration. Please try again. Error: "+t.message}finally{f.value=!1}},C=t=>({"per-week":"weeks","per-month":"months","per-term":"terms"})[t]||"months";return B(()=>{m.value?.id&&A.value&&b.value?S():l.value="Missing required information. Please select a project first."}),(t,o)=>(u(),i("div",Q,[F(H,{title:t.$t("programRegistration"),subtitle:t.$t("completeRegistrationFor")+a.value?.name},null,8,["title","subtitle"]),$.value?(u(),i("div",X,[o[7]||(o[7]=e("div",{class:"loading-spinner"},null,-1)),e("p",null,s(t.$t("loadingProgramDetails")),1)])):l.value?(u(),i("div",K,[o[8]||(o[8]=e("div",{class:"error-icon"},"⚠️",-1)),e("h3",null,s(t.$t("somethingWentWrong")),1),e("p",null,s(l.value),1),e("button",{onClick:S,class:"retry-btn"},s(t.$t("tryAgain")),1)])):a.value&&c.value?(u(),i("div",L,[e("div",Y,[e("div",Z,[e("div",x,[e("div",ee,s(a.value.category||"Sports"),1),e("h3",null,s(a.value.name),1),e("div",te,"📍 "+s(c.value.name),1)]),e("div",ae,[e("div",se,s(I.value)+" EGP",1),o[9]||(o[9]=e("div",{class:"price-note"},"Total Cost",-1))])]),e("div",oe,[a.value.ageGroup?(u(),i("span",re,s(a.value.ageGroup),1)):h("",!0),a.value.duration&&(a.value.pricingType==="per-month"||a.value.pricingType==="per-week"||a.value.pricingType==="per-term")?(u(),i("span",ne," ⏱️ "+s(a.value.duration)+" "+s(C(a.value.pricingType)),1)):h("",!0),a.value.maxCapacity?(u(),i("span",le,s(a.value.maxCapacity)+" spots",1)):h("",!0)])]),e("div",ie,[e("h2",ue,s(t.$t("registrationDetails")),1),e("form",{onSubmit:W(V,["prevent"])},[e("div",de,[e("label",ce,s(t.$t("studentName"))+" *",1),p(e("input",{id:"studentName","onUpdate:modelValue":o[0]||(o[0]=n=>r.value.studentName=n),type:"text",required:"",placeholder:t.$t("enterStudentName"),class:"form-input"},null,8,me),[[v,r.value.studentName]])]),e("div",pe,[e("label",ve,s(t.$t("studentAge"))+" *",1),p(e("input",{id:"studentAge","onUpdate:modelValue":o[1]||(o[1]=n=>r.value.studentAge=n),type:"number",min:"3",max:"100",required:"",placeholder:t.$t("enterStudentAge"),class:"form-input"},null,8,ge),[[v,r.value.studentAge]])]),e("div",fe,[e("label",ye,s(t.$t("parentGuardianName"))+" *",1),p(e("input",{id:"parentName","onUpdate:modelValue":o[2]||(o[2]=n=>r.value.parentName=n),type:"text",required:"",placeholder:t.$t("enterParentName"),class:"form-input"},null,8,he),[[v,r.value.parentName]])]),e("div",_e,[e("label",be,s(t.$t("phoneNumber"))+" *",1),p(e("input",{id:"phone","onUpdate:modelValue":o[3]||(o[3]=n=>r.value.phone=n),type:"tel",required:"",placeholder:t.$t("enterPhoneNumber"),class:"form-input"},null,8,Ne),[[v,r.value.phone]])]),e("div",$e,[e("label",Ae,s(t.$t("emailAddress")),1),p(e("input",{id:"email","onUpdate:modelValue":o[4]||(o[4]=n=>r.value.email=n),type:"email",placeholder:t.$t("enterEmailOptional"),class:"form-input"},null,8,ke),[[v,r.value.email]])]),e("div",Pe,[e("label",Te,s(t.$t("additionalNotes")),1),p(e("textarea",{id:"notes","onUpdate:modelValue":o[5]||(o[5]=n=>r.value.notes=n),placeholder:t.$t("specialRequirements"),class:"form-textarea",rows:"3"},null,8,Ie),[[v,r.value.notes]])]),e("div",Se,[e("button",{type:"button",onClick:o[6]||(o[6]=n=>t.$router.go(-1)),class:"cancel-btn",disabled:f.value},s(t.$t("cancel")),9,we),e("button",{type:"submit",class:"submit-btn",disabled:f.value},[f.value?(u(),i("span",Re,[e("div",qe,[o[10]||(o[10]=e("div",{class:"spinner"},null,-1)),_(" "+s(t.$t("processing")),1)])])):(u(),i("span",Ve,s(t.$t("completeRegistration")),1))],8,De)])],32)]),P.value?(u(),i("div",Ce,[o[11]||(o[11]=e("div",{class:"success-icon"},"✅",-1)),e("h3",null,s(t.$t("registrationSuccessful")),1),e("p",null,s(t.$t("academyRegistrationSubmitted")),1),e("div",Ue,[e("p",null,[e("strong",null,s(t.$t("registrationID"))+":",1),_(" "+s(T.value),1)]),e("p",null,[e("strong",null,s(t.$t("program"))+":",1),_(" "+s(a.value.name),1)]),e("p",null,[e("strong",null,s(t.$t("academyTitle"))+":",1),_(" "+s(c.value.name),1)]),e("p",null,[e("strong",null,s(t.$t("student"))+":",1),_(" "+s(r.value.studentName),1)])]),e("p",je,s(t.$t("redirectNotice")),1)])):h("",!0)])):h("",!0)]))}}),Oe=j(Ee,[["__scopeId","data-v-6f256515"]]);export{Oe as default};
