import{bl as G,bK as j,bL as oe,bM as le,bN as ie,bO as _e,r as N,c as m,bo as c,bP as Se,bQ as se,bR as pe,bS as F,bT as ue,bU as ke,bV as Ce,bW as xe,bX as Ie,bY as we,bZ as qe,aF as A,b_ as Le,b$ as W,aU as Be,aZ as Te,c0 as q,aC as Ee,ay as Y,aE as $e,aG as E,aH as w,aI as n,aJ as i,aN as O,aM as Z,aO as b,aS as h,ba as z,b5 as $,aQ as B,c1 as U,c2 as J,c3 as X}from"./index-BYuuB5GE.js";import{u as Ne,Q as Oe}from"./useBluetooth-pIL8G3yN.js";const De=G({name:"QItem",props:{...oe,...j,tag:{type:String,default:"div"},active:{type:Boolean,default:null},clickable:Boolean,dense:Boolean,insetLevel:Number,tabindex:[String,Number],focused:Boolean,manualFocus:Boolean},emits:["click","keyup"],setup(e,{slots:g,emit:r}){const{proxy:{$q:s}}=le(),y=ie(e,s),{hasLink:d,linkAttrs:p,linkClass:_,linkTag:k,navigateOnClick:L}=_e(),f=N(null),l=N(null),u=m(()=>e.clickable===!0||d.value===!0||e.tag==="label"),C=m(()=>e.disable!==!0&&u.value===!0),D=m(()=>"q-item q-item-type row no-wrap"+(e.dense===!0?" q-item--dense":"")+(y.value===!0?" q-item--dark":"")+(d.value===!0&&e.active===null?_.value:e.active===!0?` q-item--active${e.activeClass!==void 0?` ${e.activeClass}`:""}`:"")+(e.disable===!0?" disabled":"")+(C.value===!0?" q-item--clickable q-link cursor-pointer "+(e.manualFocus===!0?"q-manual-focusable":"q-focusable q-hoverable")+(e.focused===!0?" q-manual-focusable--focused":""):"")),a=m(()=>e.insetLevel===void 0?null:{["padding"+(s.lang.rtl===!0?"Right":"Left")]:16+e.insetLevel*56+"px"});function S(t){C.value===!0&&(l.value!==null&&t.qAvoidFocus!==!0&&(t.qKeyEvent!==!0&&document.activeElement===f.value?l.value.focus():document.activeElement===l.value&&f.value.focus()),L(t))}function x(t){if(C.value===!0&&Se(t,[13,32])===!0){se(t),t.qKeyEvent=!0;const v=new MouseEvent("click",t);v.qKeyEvent=!0,f.value.dispatchEvent(v)}r("keyup",t)}function I(){const t=pe(g.default,[]);return C.value===!0&&t.unshift(c("div",{class:"q-focus-helper",tabindex:-1,ref:l})),t}return()=>{const t={ref:f,class:D.value,style:a.value,role:"listitem",onClick:S,onKeyup:x};return C.value===!0?(t.tabindex=e.tabindex||"0",Object.assign(t,p.value)):u.value===!0&&(t["aria-disabled"]="true"),c(k.value,t,I())}}}),R=G({name:"QItemSection",props:{avatar:Boolean,thumbnail:Boolean,side:Boolean,top:Boolean,noWrap:Boolean},setup(e,{slots:g}){const r=m(()=>`q-item__section column q-item__section--${e.avatar===!0||e.side===!0||e.thumbnail===!0?"side":"main"}`+(e.top===!0?" q-item__section--top justify-start":" justify-center")+(e.avatar===!0?" q-item__section--avatar":"")+(e.thumbnail===!0?" q-item__section--thumbnail":"")+(e.noWrap===!0?" q-item__section--nowrap":""));return()=>c("div",{class:r.value},F(g.default))}}),ee=G({name:"QItemLabel",props:{overline:Boolean,caption:Boolean,header:Boolean,lines:[Number,String]},setup(e,{slots:g}){const r=m(()=>parseInt(e.lines,10)),s=m(()=>"q-item__label"+(e.overline===!0?" q-item__label--overline text-overline":"")+(e.caption===!0?" q-item__label--caption text-caption":"")+(e.header===!0?" q-item__label--header":"")+(r.value===1?" ellipsis":"")),y=m(()=>e.lines!==void 0&&r.value>1?{overflow:"hidden",display:"-webkit-box","-webkit-box-orient":"vertical","-webkit-line-clamp":r.value}:null);return()=>c("div",{style:y.value,class:s.value},F(g.default))}}),Pe=G({name:"QSlideTransition",props:{appear:Boolean,duration:{type:Number,default:300}},emits:["show","hide"],setup(e,{slots:g,emit:r}){let s=!1,y,d,p=null,_=null,k,L;function f(){y?.(),y=null,s=!1,p!==null&&(clearTimeout(p),p=null),_!==null&&(clearTimeout(_),_=null),d?.removeEventListener("transitionend",k),k=null}function l(a,S,x){S!==void 0&&(a.style.height=`${S}px`),a.style.transition=`height ${e.duration}ms cubic-bezier(.25, .8, .50, 1)`,s=!0,y=x}function u(a,S){a.style.overflowY=null,a.style.height=null,a.style.transition=null,f(),S!==L&&r(S)}function C(a,S){let x=0;d=a,s===!0?(f(),x=a.offsetHeight===a.scrollHeight?0:void 0):(L="hide",a.style.overflowY="hidden"),l(a,x,S),p=setTimeout(()=>{p=null,a.style.height=`${a.scrollHeight}px`,k=I=>{_=null,(Object(I)!==I||I.target===a)&&u(a,"show")},a.addEventListener("transitionend",k),_=setTimeout(k,e.duration*1.1)},100)}function D(a,S){let x;d=a,s===!0?f():(L="show",a.style.overflowY="hidden",x=a.scrollHeight),l(a,x,S),p=setTimeout(()=>{p=null,a.style.height=0,k=I=>{_=null,(Object(I)!==I||I.target===a)&&u(a,"hide")},a.addEventListener("transitionend",k),_=setTimeout(k,e.duration*1.1)},100)}return ue(()=>{s===!0&&f()}),()=>c(ke,{css:!1,appear:e.appear,onEnter:C,onLeave:D},g.default)}}),P=Ce({}),Ge=Object.keys(j),te=G({name:"QExpansionItem",props:{...j,...Ie,...oe,icon:String,label:String,labelLines:[Number,String],caption:String,captionLines:[Number,String],dense:Boolean,toggleAriaLabel:String,expandIcon:String,expandedIcon:String,expandIconClass:[Array,String,Object],duration:{},headerInsetLevel:Number,contentInsetLevel:Number,expandSeparator:Boolean,defaultOpened:Boolean,hideExpandIcon:Boolean,expandIconToggle:Boolean,switchToggleSide:Boolean,denseToggle:Boolean,group:String,popup:Boolean,headerStyle:[Array,String,Object],headerClass:[Array,String,Object]},emits:[...xe,"click","afterShow","afterHide"],setup(e,{slots:g,emit:r}){const{proxy:{$q:s}}=le(),y=ie(e,s),d=N(e.modelValue!==null?e.modelValue:e.defaultOpened),p=N(null),_=we(),{show:k,hide:L,toggle:f}=qe({showing:d});let l,u;const C=m(()=>`q-expansion-item q-item-type q-expansion-item--${d.value===!0?"expanded":"collapsed"} q-expansion-item--${e.popup===!0?"popup":"standard"}`),D=m(()=>e.contentInsetLevel===void 0?null:{["padding"+(s.lang.rtl===!0?"Right":"Left")]:e.contentInsetLevel*56+"px"}),a=m(()=>e.disable!==!0&&(e.href!==void 0||e.to!==void 0&&e.to!==null&&e.to!=="")),S=m(()=>{const o={};return Ge.forEach(T=>{o[T]=e[T]}),o}),x=m(()=>a.value===!0||e.expandIconToggle!==!0),I=m(()=>e.expandedIcon!==void 0&&d.value===!0?e.expandedIcon:e.expandIcon||s.iconSet.expansionItem[e.denseToggle===!0?"denseIcon":"icon"]),t=m(()=>e.disable!==!0&&(a.value===!0||e.expandIconToggle===!0)),v=m(()=>({expanded:d.value===!0,detailsId:_.value,toggle:f,show:k,hide:L})),M=m(()=>{const o=e.toggleAriaLabel!==void 0?e.toggleAriaLabel:s.lang.label[d.value===!0?"collapse":"expand"](e.label);return{role:"button","aria-expanded":d.value===!0?"true":"false","aria-controls":_.value,"aria-label":o}});A(()=>e.group,o=>{u?.(),o!==void 0&&V()});function ce(o){a.value!==!0&&f(o),r("click",o)}function re(o){o.keyCode===13&&K(o,!0)}function K(o,T){T!==!0&&o.qAvoidFocus!==!0&&p.value?.focus(),f(o),se(o)}function de(){r("afterShow")}function ve(){r("afterHide")}function V(){l===void 0&&(l=Le()),d.value===!0&&(P[e.group]=l);const o=A(d,Q=>{Q===!0?P[e.group]=l:P[e.group]===l&&delete P[e.group]}),T=A(()=>P[e.group],(Q,ye)=>{ye===l&&Q!==void 0&&Q!==l&&L()});u=()=>{o(),T(),P[e.group]===l&&delete P[e.group],u=void 0}}function ge(){const o={class:[`q-focusable relative-position cursor-pointer${e.denseToggle===!0&&e.switchToggleSide===!0?" items-end":""}`,e.expandIconClass],side:e.switchToggleSide!==!0,avatar:e.switchToggleSide},T=[c(q,{class:"q-expansion-item__toggle-icon"+(e.expandedIcon===void 0&&d.value===!0?" q-expansion-item__toggle-icon--rotated":""),name:I.value})];return t.value===!0&&(Object.assign(o,{tabindex:0,...M.value,onClick:K,onKeyup:re}),T.unshift(c("div",{ref:p,class:"q-expansion-item__toggle-focus q-icon q-focus-helper q-focus-helper--rounded",tabindex:-1}))),c(R,o,()=>T)}function fe(){let o;return g.header!==void 0?o=[].concat(g.header(v.value)):(o=[c(R,()=>[c(ee,{lines:e.labelLines},()=>e.label||""),e.caption?c(ee,{lines:e.captionLines,caption:!0},()=>e.caption):null])],e.icon&&o[e.switchToggleSide===!0?"push":"unshift"](c(R,{side:e.switchToggleSide===!0,avatar:e.switchToggleSide!==!0},()=>c(q,{name:e.icon})))),e.disable!==!0&&e.hideExpandIcon!==!0&&o[e.switchToggleSide===!0?"unshift":"push"](ge()),o}function be(){const o={ref:"item",style:e.headerStyle,class:e.headerClass,dark:y.value,disable:e.disable,dense:e.dense,insetLevel:e.headerInsetLevel};return x.value===!0&&(o.clickable=!0,o.onClick=ce,Object.assign(o,a.value===!0?S.value:M.value)),c(De,o,fe)}function me(){return Be(c("div",{key:"e-content",class:"q-expansion-item__content relative-position",style:D.value,id:_.value},F(g.default)),[[Te,d.value]])}function he(){const o=[be(),c(Pe,{duration:e.duration,onShow:de,onHide:ve},me)];return e.expandSeparator===!0&&o.push(c(W,{class:"q-expansion-item__border q-expansion-item__border--top absolute-top",dark:y.value}),c(W,{class:"q-expansion-item__border q-expansion-item__border--bottom absolute-bottom",dark:y.value})),o}return e.group!==void 0&&V(),ue(()=>{u?.()}),()=>c("div",{class:C.value},[c("div",{class:"q-expansion-item__container relative-position"},he())])}}),Qe={class:"gate-control-page"},Ae={class:"page-header"},ze={class:"control-card"},Ue={class:"bluetooth-icon-container"},Re={key:0,class:"pulse-ring"},He={class:"status-section"},je={key:0,class:"status-indicator connected"},Fe={key:1,class:"status-indicator connecting"},Me={key:2,class:"status-indicator disconnected"},Ke={key:3,class:"device-name"},Ve={key:0,class:"warning-banner"},We={class:"warning-text"},Ye={class:"button-group"},Ze={class:"info-section"},Je={class:"instructions-list"},Xe={key:2,class:"debug-section"},et={class:"debug-info"},H="12345678-1234-5678-1234-56789abcdef0",ne="abcdefab-cdef-1234-5678-abcdefabcdef",ae="OPEN123",tt=Object.assign({name:"GateControlPage"},{__name:"GateControlPage",setup(e){const{isConnected:g,isConnecting:r,isBLESupported:s,deviceName:y,lastError:d,checkBLESupport:p,connect:_,write:k,disconnect:L}=Ne(),f=N(!1),l=N(""),u=N(""),C=N(!1),D=N(!1),a=m(()=>Y.isNativePlatform()?Y.getPlatform():"web"),S=async()=>{try{console.log("🔵 Starting BLE connection process..."),l.value="",await _(H)?(console.log("✅ Successfully connected to gate device"),l.value="Successfully connected to gate device",u.value="success",setTimeout(()=>{l.value==="Successfully connected to gate device"&&(l.value="")},3e3)):(console.log("❌ Failed to connect to gate device"),l.value="Failed to connect. Please try again.",u.value="error")}catch(t){console.error("❌ Connection error:",t),l.value=t.message||"Connection failed",u.value="error"}},x=async()=>{console.log("🔌 Disconnecting from gate device..."),l.value="",await L()},I=async()=>{try{f.value=!0,l.value="",console.log("🚪 Sending open gate command..."),console.log("📝 Command:",ae),await k(H,ne,ae)?(console.log("✅ Gate command sent successfully"),l.value="Gate opened successfully! 🎉",u.value="success",setTimeout(()=>{l.value.includes("Gate opened successfully")&&(l.value="")},5e3)):(console.log("❌ Failed to send gate command"),l.value="Failed to open gate. Please try again.",u.value="error")}catch(t){console.error("❌ Error opening gate:",t),l.value=t.message||"Failed to open gate",u.value="error"}finally{f.value=!1}};return $e(async()=>{console.log("🚀 GateControlPage mounted"),console.log("📱 Platform:",a.value),await p(),C.value=!0,s.value?console.log("✅ BLE is supported"):(console.warn("⚠️ BLE is not supported on this device/browser"),l.value="Bluetooth is not available on this device",u.value="error")}),(t,v)=>(w(),E("div",Qe,[n("div",Ae,[n("h1",null,i(t.$t("gateControl")||"Gate Control"),1),n("p",null,i(t.$t("gateControlDesc")||"Connect to your BLE gate device and control access"),1)]),n("div",ze,[n("div",Ue,[n("div",{class:Z(["bluetooth-icon",{connected:b(g),connecting:b(r)}])},[h(q,{name:"bluetooth",size:"48px"}),b(r)?(w(),E("div",Re)):O("",!0)],2)]),n("div",He,[b(g)?(w(),E("div",je,[h(q,{name:"check_circle",size:"20px"}),n("span",null,i(t.$t("connected")||"Connected"),1)])):b(r)?(w(),E("div",Fe,[h(Oe,{size:"20px",color:"primary"}),n("span",null,i(t.$t("connecting")||"Connecting..."),1)])):(w(),E("div",Me,[h(q,{name:"cancel",size:"20px"}),n("span",null,i(t.$t("disconnected")||"Disconnected"),1)])),b(y)?(w(),E("div",Ke,[h(q,{name:"devices",size:"16px"}),n("span",null,i(b(y)),1)])):O("",!0)]),!b(s)&&C.value?(w(),E("div",Ve,[h(q,{name:"warning",size:"24px"}),n("div",We,[n("strong",null,i(t.$t("bleNotSupported")||"Bluetooth Not Supported"),1),n("p",null,i(t.$t("bleNotSupportedDesc")||"Your device or browser does not support Bluetooth Low Energy. Please use a compatible device or enable Bluetooth."),1)])])):O("",!0),n("div",Ye,[b(g)?O("",!0):(w(),z(U,{key:0,unelevated:"",rounded:"",color:"primary",size:"lg",class:"action-button",loading:b(r),disable:b(r)||C.value&&!b(s),onClick:S},{default:$(()=>[h(q,{name:"bluetooth_searching",size:"24px",left:""}),B(" "+i(t.$t("connect")||"Connect to Gate"),1)]),_:1},8,["loading","disable"])),b(g)?(w(),z(U,{key:1,unelevated:"",rounded:"",color:"positive",size:"lg",class:"action-button",loading:f.value,disable:f.value,onClick:I},{default:$(()=>[h(q,{name:"door_open",size:"24px",left:""}),B(" "+i(t.$t("openGate")||"Open Gate"),1)]),_:1},8,["loading","disable"])):O("",!0),b(g)?(w(),z(U,{key:2,flat:"",rounded:"",color:"negative",size:"md",class:"secondary-button",onClick:x},{default:$(()=>[h(q,{name:"bluetooth_disabled",size:"20px",left:""}),B(" "+i(t.$t("disconnect")||"Disconnect"),1)]),_:1})):O("",!0)]),l.value?(w(),E("div",{key:1,class:Z(["status-message",u.value])},[h(q,{name:u.value==="success"?"check_circle":"error",size:"20px"},null,8,["name"]),n("span",null,i(l.value),1)],2)):O("",!0),n("div",Ze,[h(te,{icon:"info",label:t.$t("howToUse")||"How to Use","header-class":"text-primary"},{default:$(()=>[h(J,{class:"info-card"},{default:$(()=>[h(X,null,{default:$(()=>[n("ol",Je,[n("li",null,i(t.$t("instruction1")||"Make sure Bluetooth is enabled on your device"),1),n("li",null,i(t.$t("instruction2")||'Tap "Connect to Gate" to scan for nearby BLE devices'),1),n("li",null,i(t.$t("instruction3")||"Select your gate device from the list"),1),n("li",null,i(t.$t("instruction4")||'Once connected, tap "Open Gate" to send the unlock command'),1),n("li",null,i(t.$t("instruction5")||"Wait for confirmation that the gate has opened"),1)])]),_:1})]),_:1})]),_:1},8,["label"])]),D.value?(w(),E("div",Xe,[h(te,{icon:"bug_report",label:"Debug Info","header-class":"text-grey"},{default:$(()=>[h(J,{class:"debug-card"},{default:$(()=>[h(X,null,{default:$(()=>[n("div",et,[n("p",null,[v[0]||(v[0]=n("strong",null,"Platform:",-1)),B(" "+i(a.value),1)]),n("p",null,[v[1]||(v[1]=n("strong",null,"BLE Supported:",-1)),B(" "+i(b(s)),1)]),n("p",null,[v[2]||(v[2]=n("strong",null,"Connected:",-1)),B(" "+i(b(g)),1)]),n("p",null,[v[3]||(v[3]=n("strong",null,"Device:",-1)),B(" "+i(b(y)||"None"),1)]),n("p",null,[v[4]||(v[4]=n("strong",null,"Service UUID:",-1)),B(" "+i(H))]),n("p",null,[v[5]||(v[5]=n("strong",null,"Characteristic UUID:",-1)),B(" "+i(ne))]),n("p",null,[v[6]||(v[6]=n("strong",null,"Last Error:",-1)),B(" "+i(b(d)||"None"),1)])])]),_:1})]),_:1})]),_:1})])):O("",!0)])]))}}),ot=Ee(tt,[["__scopeId","data-v-9ad0c728"]]);export{ot as default};
