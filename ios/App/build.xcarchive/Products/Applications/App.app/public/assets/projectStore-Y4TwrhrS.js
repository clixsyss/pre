import{u as n,o as a}from"./index-BYuuB5GE.js";const l=async({app:s})=>{const t=n();let o=null;const c=a.onAuthStateChanged(async e=>{if(console.log("App boot: Auth state changed, user:",e?"authenticated":"not authenticated"),e){if(o===e.uid){console.log("App boot: User already processed, skipping rehydration");return}o=e.uid,console.log("App boot: User authenticated, rehydrating project store...","User ID:",e.uid);try{await t.rehydrateStore(e.uid)?(console.log("App boot: Project store rehydrated successfully"),window.dispatchEvent(new CustomEvent("projectStoreReady",{detail:{projectId:t.selectedProject?.id}}))):console.log("App boot: No project restored, user needs to select")}catch(r){console.error("App boot: Error rehydrating project store:",r),o=null}}else console.log("App boot: No user authenticated"),o=null,t.resetStore()});s.config.globalProperties.$cleanupProjectStore=()=>{c()}};export{l as default};
